(this.webpackJsonpmapchat=this.webpackJsonpmapchat||[]).push([[0],{28:function(e,t,a){e.exports=a.p+"static/media/userlocation.550199a8.svg"},29:function(e,t,a){e.exports=a.p+"static/media/messagelocation.a7dfc8ba.svg"},34:function(e,t,a){e.exports=a(52)},39:function(e,t,a){},44:function(e,t,a){},52:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),s=a(11),r=a.n(s),c=(a(39),a(12)),i=a(18),l=a(26),m=a(27),u=a(32),g=a(31),h=a(65),p=a(64),d=a(28),f=a.n(d),v=a(29),E=a.n(v),b=a(9),y=a.n(b),M=(a(20),a(21),a(67)),S=a(66),w=a(54),L=a(68),C=function(e){return o.a.createElement(M.a,{className:"map",center:e.position,zoom:e.zoom},o.a.createElement(S.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.userLocation?o.a.createElement(w.a,{icon:e.userIcon,position:e.position}):"",e.messages.map((function(t){return o.a.createElement(w.a,{key:t._id,icon:e.messageIcon,position:[t.latitude,t.longitude]},o.a.createElement(L.a,null,o.a.createElement("strong",null,t.name,":"),t.message))})))},j=a(55),O=a(56),z=a(57),N=a(58),k=a(59),T=a(60),x=a(61),A=a(62),I=a(63),F=function(e){return o.a.createElement(j.a,{className:"message-form",body:!0},o.a.createElement("div",{className:"message-header"},o.a.createElement(O.a,null,o.a.createElement("strong",null,"Welcome to Map Chat!!")),o.a.createElement(z.a,null,"Leave a message with your location")),o.a.createElement("div",{className:"message-body"},e.sentMessage?"":o.a.createElement(N.a,{onSubmit:e.formSubmit},o.a.createElement(k.a,{row:!0},o.a.createElement(T.a,{for:"name",sm:4},"Name"),o.a.createElement(x.a,{sm:10},o.a.createElement(A.a,{onChange:e.valueChanged,type:"text",name:"name",id:"name",placeholder:"Enter your name"}))),o.a.createElement(k.a,{row:!0},o.a.createElement(T.a,{for:"message",sm:4},"Message"),o.a.createElement(x.a,{sm:10},o.a.createElement(A.a,{onChange:e.valueChanged,type:"textarea",name:"message",id:"message",placeholder:"Enter a message"}))),o.a.createElement(I.a,{type:"submit",disabled:!e.userLocation,className:"submit-bt"},"Send"))))},P="localhost"===window.location.hostname?"http://localhost:8000/messages":"https://mapchatnearby.herokuapp.com/messages";a(44);var B=y.a.icon({iconUrl:f.a,iconSize:[40,40],iconAnchor:[20,40]}),J=y.a.icon({iconUrl:E.a,iconSize:[40,40],iconAnchor:[20,40],popupAnchor:[0,-40]}),W=function(e){Object(u.a)(a,e);var t=Object(g.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).validateForm=function(){console.log("Validating form");var t=e.state.location,a=t.lat,n=t.lng,o=e.state.userMessage,s=o.name,r=o.message;return a<-90||a>90?{error:"Latitude should be in a range of -90 to 90",response:!1}:n<-180||n>180?{error:"Longitude should be in a range of -180 to 180",response:!1}:s.length<5||s.length>50?{error:"Name should be 5 to 50 characters long",response:!1}:r.length<5||r.length>200?{error:"Message should be 5 to 200 characters long",response:!1}:{error:"",response:!0}},e.formSubmit=function(t){t.preventDefault(),e.setState({sentMessage:!1});var a=e.validateForm(),n=a.error;a.response?function(e){return fetch(P,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(e)})}({name:e.state.userMessage.name,message:e.state.userMessage.message,latitude:e.state.location.lat,longitude:e.state.location.lng}).then((function(){e.setState({sentMessage:!0,showToast:!0}),setTimeout((function(){e.setState({showToast:!1})}),3e3)})).catch((function(e){console.log("POST error",e)})):console.log(n)},e.valueChanged=function(t){e.validateForm();var a=t.target,n=a.name,o=a.value;e.setState((function(e){return{userMessage:Object(i.a)(Object(i.a)({},e.userMessage),{},Object(c.a)({},n,o))}}))},e.state={location:{lat:22,lng:80},zoom:5,userLocation:!1,userMessage:{name:"",message:""},sentMessage:!1,showToast:!1,messages:[]},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch(P,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({messages:t})})).catch((function(e){console.log("Fetch get error ",e)})),new Promise((function(e){navigator.geolocation.getCurrentPosition((function(t){e({lat:t.coords.latitude,lng:t.coords.longitude,zoom:12,userLocation:!0})}),(function(e){console.log("Location Blocked by user")}),{maximumAge:1e4,timeout:5e3,enableHighAccuracy:!0})})).then((function(t){e.setState({location:t,zoom:12,userLocation:!0})}))}},{key:"render",value:function(){var e=[this.state.location.lat,this.state.location.lng];return o.a.createElement("div",{className:"map"},o.a.createElement(C,{zoom:this.state.zoom,userLocation:this.state.userLocation,messages:this.state.messages,position:e,userIcon:B,messageIcon:J}),this.state.sentMessage?this.state.showToast?o.a.createElement("div",{className:"toast-div p-3 my-2 rounded"},o.a.createElement(h.a,null,o.a.createElement(p.a,null,"Message sent !!"))):"":o.a.createElement(F,{sentMessage:this.state.sentMessage,formSubmit:this.formSubmit,valueChanged:this.valueChanged,userLocation:this.state.userLocation}))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[34,1,2]]]);
//# sourceMappingURL=main.ec37c24f.chunk.js.map